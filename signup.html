<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì… - ìš°ë¦¬ë°˜ í™ˆí˜ì´ì§€</title>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>ğŸ“ íšŒì›ê°€ì…</h1>
        <nav><a href="index.html">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</a></nav>
    </header>
    <main>
        <div class="form-container">
            <form id="signup-form">
                <input type="text" id="name" placeholder="ì´ë¦„" required>
                <input type="email" id="email" placeholder="ì´ë©”ì¼ (ì•„ì´ë””ë¡œ ì‚¬ìš©)" required>
                <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" required>
                <input type="password" id="password-confirm" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" required>
                <button type="submit" class="btn-submit">ê°€ì…í•˜ê¸°</button>
            </form>
            <p style="margin-top:15px;">ì´ë¯¸ ê³„ì •ì´ ìˆë‚˜ìš”? <a href="login.html">ë¡œê·¸ì¸</a></p>
        </div>
    </main>

    <script type="module">
        import { auth, db } from './firebase-init.js';
        import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const signupForm = document.getElementById('signup-form');
        signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const confirm = document.getElementById('password-confirm').value;

            if (email.toLowerCase().includes('admin')) {
                alert("ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.");
                return;
            }

            if (password !== confirm) {
                alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                // Firestoreì— ì‚¬ìš©ì ì¶”ê°€ ì •ë³´ ì €ì¥
                await setDoc(doc(db, "users", userCredential.user.uid), { name, email });
                alert("íšŒì›ê°€ì… ì„±ê³µ!");
                window.location.href = 'index.html';
            } catch (error) {
                alert("ê°€ì… ì‹¤íŒ¨: " + error.message);
            }
        });
    </script>
</body>
</html>